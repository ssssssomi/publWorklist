<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no, address=no, email=no">
  <title>WORKLIST</title>

  <link rel="stylesheet" type="text/css" href="./assets/css/common.css">

  <!-- worklist ì „ìš© ìµœì†Œ ìŠ¤íƒ€ì¼(ê³µí†µcssì— í•©ì¹  ì˜ˆì •ì´ë©´ ì´ë™) -->
  <style>
    .worklist-wrap { padding: 24px; }
    .worklist-head { display:flex; gap:12px; align-items:flex-end; justify-content:space-between; flex-wrap:wrap; margin-bottom:16px; }
    .worklist-title { font-size: 20px; font-weight: 700; margin: 0; }
    .worklist-meta { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .worklist-meta .field { display:flex; gap:6px; align-items:center; }
    .worklist-meta label { font-size: 14px; }
    .worklist-meta input[type="search"], .worklist-meta select { height: 36px; padding: 0 10px; border: 1px solid #cfcfcf; border-radius: 8px; }
    .worklist-table-wrap { overflow:auto; border: 1px solid #e6e6e6; border-radius: 12px; background:#fff; }
    table.worklist-table { width: 100%; border-collapse: collapse; min-width: 1100px; }
    table.worklist-table caption { padding: 12px; font-weight: 600; text-align: left; }
    table.worklist-table th, table.worklist-table td { padding: 10px 12px; border-top: 1px solid #eee; vertical-align: top; }
    table.worklist-table thead th { position: sticky; top: 0; background: #fafafa; border-top: none; z-index: 1; }
    table.worklist-table th { text-align: left; font-weight: 600; }
    table.worklist-table td small { display:block; color:#666; }

    .btn-preview {
      display:inline-flex; align-items:center; gap:6px;
      height: 32px; padding: 0 10px;
      border: 1px solid #cfcfcf; border-radius: 999px;
      background: #fff; cursor: pointer;
      font-size: 14px;
    }
    .btn-preview:focus-visible, .btn-close:focus-visible {
      outline: 2px solid #1f3a56;
      outline-offset: 2px;
    }

    .status { display:inline-flex; align-items:center; height: 26px; padding: 0 10px; border-radius: 999px; font-size: 13px; border:1px solid #ddd; background:#fff; }
    .status[data-status="done"] { border-color:#b9d9c7; }
    .status[data-status="progress"] { border-color:#f0d7a6; }
    .status[data-status="todo"] { border-color:#e3e3e3; }

    /* Dialog */
    .dialog-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.55); display:none; }
    .dialog-backdrop.is-open { display:block; }
    .dialog { position: fixed; inset: 0; display:none; align-items:center; justify-content:center; padding: 16px; }
    .dialog.is-open { display:flex; }
    .dialog-panel { width: min(1100px, 100%); height: min(80vh, 720px); background:#fff; border-radius: 16px; overflow:hidden; box-shadow: 0 10px 40px rgba(0,0,0,.25); display:flex; flex-direction:column; }
    .dialog-head { display:flex; gap:12px; align-items:center; justify-content:space-between; padding: 12px 16px; border-bottom:1px solid #eee; }
    .dialog-title { margin:0; font-size: 16px; font-weight: 700; }
    .btn-close { height: 36px; padding: 0 12px; border: 1px solid #cfcfcf; border-radius: 10px; background:#fff; cursor:pointer; }
    .dialog-body { flex:1; min-height:0; }
    .preview-frame { width:100%; height:100%; border:0; display:block; background:#fff; }
    .dialog-note { padding: 8px 16px; border-top:1px solid #eee; font-size: 13px; color:#555; }
  </style>
</head>

<body class="ui-content" data-page="worklist">
  <div class="worklist-wrap">

    <header class="worklist-head">
      <h1 class="worklist-title">í¼ë¸”ë¦¬ì‹± ì›Œí¬ë¦¬ìŠ¤íŠ¸</h1>

      <div class="worklist-meta" role="search" aria-label="ì›Œí¬ë¦¬ìŠ¤íŠ¸ í•„í„°">
        <div class="field">
          <label for="wlSearch">ê²€ìƒ‰</label>
          <input id="wlSearch" type="search" placeholder="í™”ë©´ ID, í™”ë©´ëª…, ê²½ë¡œ ê²€ìƒ‰" autocomplete="off">
        </div>

        <div class="field">
          <label for="wlStatus">ìƒíƒœ</label>
          <select id="wlStatus">
            <option value="all">ì „ì²´</option>
            <option value="todo">ì˜ˆì •</option>
            <option value="progress">ì§„í–‰ì¤‘</option>
            <option value="done">ì™„ë£Œ</option>
          </select>
        </div>
      </div>
    </header>

    <div class="worklist-table-wrap" role="region" aria-label="í¼ë¸”ë¦¬ì‹± ì›Œí¬ë¦¬ìŠ¤íŠ¸ í‘œ" tabindex="0">
      <table class="worklist-table">
        <caption>í™”ë©´ë³„ í¼ë¸”ë¦¬ì‹± í˜„í™© ë° ë¯¸ë¦¬ë³´ê¸° ë§í¬</caption>
        <thead>
          <tr>
            <th scope="col" style="width:56px;">No</th>
            <th scope="col" style="width:120px;">í™”ë©´ ID</th>
            <th scope="col" style="width:120px;">ë¯¸ë¦¬ë³´ê¸°</th>
            <th scope="col" style="width:120px;">1Depth</th>
            <th scope="col" style="width:140px;">2Depth</th>
            <th scope="col" style="width:220px;">í™”ë©´ëª…</th>
            <th scope="col" style="width:260px;">ê²½ë¡œ(URL)</th>
            <th scope="col" style="width:180px;">íŒŒì¼ëª…</th>
            <th scope="col" style="width:120px;">ìƒíƒœ</th>
            <th scope="col">ë¹„ê³ </th>
          </tr>
        </thead>

        <tbody id="wlTbody">
          <!-- ì˜ˆì‹œ row 1 -->
          <tr data-status="done">
            <th scope="row">1</th>
            <td><strong>MAIN_001</strong></td>
            <td>
              <button
                type="button"
                class="btn-preview"
                data-preview-src="./html/main.html"
                data-preview-title="MAIN_001 ë©”ì¸"
                aria-haspopup="dialog"
                aria-controls="previewDialog"
              >
                ğŸ” <span>ë³´ê¸°</span>
              </button>
              <small>./html/main.html</small>
            </td>
            <td>ë©”ì¸</td>
            <td>-</td>
            <td>ë©”ì¸</td>
            <td>/</td>
            <td>main.html</td>
            <td><span class="status" data-status="done">ì™„ë£Œ</span></td>
            <td></td>
          </tr>

          <!-- ì˜ˆì‹œ row 2 -->
          <tr data-status="progress">
            <th scope="row">2</th>
            <td><strong>CS_001</strong></td>
            <td>
              <button
                type="button"
                class="btn-preview"
                data-preview-src="./html/cs_faq.html"
                data-preview-title="CS_001 FAQ ëª©ë¡"
                aria-haspopup="dialog"
                aria-controls="previewDialog"
              >
                ğŸ” <span>ë³´ê¸°</span>
              </button>
              <small>./html/cs_faq.html</small>
            </td>
            <td>ê³ ê°ì„¼í„°</td>
            <td>FAQ</td>
            <td>FAQ ëª©ë¡</td>
            <td>/cs/faq</td>
            <td>cs_faq.html</td>
            <td><span class="status" data-status="progress">ì§„í–‰ì¤‘</span></td>
            <td>ê²€ìƒ‰ í¬í•¨</td>
          </tr>

          <!-- ì˜ˆì‹œ row 3 -->
          <tr data-status="todo">
            <th scope="row">3</th>
            <td><strong>CS_002</strong></td>
            <td>
              <button
                type="button"
                class="btn-preview"
                data-preview-src="./html/cs_faq_view.html"
                data-preview-title="CS_002 FAQ ìƒì„¸"
                aria-haspopup="dialog"
                aria-controls="previewDialog"
              >
                ğŸ” <span>ë³´ê¸°</span>
              </button>
              <small>./html/cs_faq_view.html</small>
            </td>
            <td>ê³ ê°ì„¼í„°</td>
            <td>FAQ</td>
            <td>FAQ ìƒì„¸</td>
            <td>/cs/faq/view</td>
            <td>cs_faq_view.html</td>
            <td><span class="status" data-status="todo">ì˜ˆì •</span></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- ì ‘ê·¼ì„±: ë‹¤ì´ì–¼ë¡œê·¸ ë°±ë“œë¡­(í´ë¦­ ì‹œ ë‹«ê¸°) -->
    <div class="dialog-backdrop" id="dialogBackdrop" hidden></div>

    <!-- Preview Dialog (a11y) -->
    <section
      class="dialog"
      id="previewDialog"
      role="dialog"
      aria-modal="true"
      aria-labelledby="previewTitle"
      aria-describedby="previewDesc"
      hidden
    >
      <div class="dialog-panel" role="document">
        <div class="dialog-head">
          <h2 class="dialog-title" id="previewTitle">ë¯¸ë¦¬ë³´ê¸°</h2>
          <button type="button" class="btn-close" id="btnClosePreview">
            ë‹«ê¸°
          </button>
        </div>

        <div class="dialog-body">
          <iframe class="preview-frame" id="previewFrame" title="ë¯¸ë¦¬ë³´ê¸° í”„ë ˆì„"></iframe>
        </div>

        <p class="dialog-note" id="previewDesc">
          Esc í‚¤ë¡œ ë‹«ì„ ìˆ˜ ìˆìœ¼ë©°, ë‹«ê¸° í›„ í¬ì»¤ìŠ¤ëŠ” ì´ì „ ë²„íŠ¼ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
        </p>
      </div>
    </section>

  </div><!-- //worklist-wrap -->

  <script>
    (function () {
      const tbody = document.getElementById('wlTbody');
      const searchEl = document.getElementById('wlSearch');
      const statusEl = document.getElementById('wlStatus');

      const dialog = document.getElementById('previewDialog');
      const backdrop = document.getElementById('dialogBackdrop');
      const frame = document.getElementById('previewFrame');
      const titleEl = document.getElementById('previewTitle');
      const closeBtn = document.getElementById('btnClosePreview');

      let lastFocusEl = null;

      function getFocusable(root) {
        return Array.from(root.querySelectorAll(
          'a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'
        ));
      }

      function openDialog(src, title) {
        lastFocusEl = document.activeElement;

        titleEl.textContent = title || 'ë¯¸ë¦¬ë³´ê¸°';
        frame.src = src || '';

        // show
        backdrop.hidden = false;
        dialog.hidden = false;
        backdrop.classList.add('is-open');
        dialog.classList.add('is-open');

        // body scroll lock (ì„ íƒ)
        document.documentElement.style.overflow = 'hidden';

        // focus
        closeBtn.focus();
      }

      function closeDialog() {
        // hide
        dialog.classList.remove('is-open');
        backdrop.classList.remove('is-open');
        dialog.hidden = true;
        backdrop.hidden = true;

        // reset
        frame.src = 'about:blank';
        document.documentElement.style.overflow = '';

        // restore focus
        if (lastFocusEl && typeof lastFocusEl.focus === 'function') {
          lastFocusEl.focus();
        }
      }

      // event: open preview
      tbody.addEventListener('click', (e) => {
        const btn = e.target.closest('.btn-preview');
        if (!btn) return;

        const src = btn.getAttribute('data-preview-src');
        const title = btn.getAttribute('data-preview-title') || 'ë¯¸ë¦¬ë³´ê¸°';
        openDialog(src, title);
      });

      // close handlers
      closeBtn.addEventListener('click', closeDialog);
      backdrop.addEventListener('click', closeDialog);

      // esc + focus trap
      document.addEventListener('keydown', (e) => {
        const isOpen = !dialog.hidden;
        if (!isOpen) return;

        if (e.key === 'Escape') {
          e.preventDefault();
          closeDialog();
          return;
        }

        if (e.key === 'Tab') {
          const focusables = getFocusable(dialog);
          if (!focusables.length) return;

          const first = focusables[0];
          const last = focusables[focusables.length - 1];

          if (e.shiftKey && document.activeElement === first) {
            e.preventDefault();
            last.focus();
          } else if (!e.shiftKey && document.activeElement === last) {
            e.preventDefault();
            first.focus();
          }
        }
      });

      // filter (search + status)
      function applyFilter() {
        const q = (searchEl.value || '').trim().toLowerCase();
        const st = statusEl.value;

        const rows = Array.from(tbody.querySelectorAll('tr'));
        rows.forEach((row) => {
          const rowStatus = row.getAttribute('data-status');
          const text = row.textContent.toLowerCase();

          const matchStatus = (st === 'all') ? true : rowStatus === st;
          const matchQuery = q ? text.includes(q) : true;

          row.style.display = (matchStatus && matchQuery) ? '' : 'none';
        });
      }

      searchEl.addEventListener('input', applyFilter);
      statusEl.addEventListener('change', applyFilter);
    })();
  </script>
</body>
</html>
